<<<<<<< HEAD
=======

>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
// import the necessary modules
var mongoose = require('../../lib');
var Schema = mongoose.Schema;

// create an export function to encapsulate the model creation
module.exports = function() {
  // define schema
  var PersonSchema = new Schema({
<<<<<<< HEAD
    name: String,
    age: Number,
    birthday: Date,
    gender: String,
    likes: [String],
    // define the geospatial field
    loc: {type: [Number], index: '2d'}
=======
    name : String,
    age : Number,
    birthday : Date,
    gender: String,
    likes: [String],
    // define the geospatial field
    loc: { type : [Number], index: '2d' }
>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
  });

  // define a method to find the closest person
  PersonSchema.methods.findClosest = function(cb) {
    return this.model('Person').find({
<<<<<<< HEAD
      loc: {$nearSphere: this.loc},
      name: {$ne: this.name}
=======
      loc : { $nearSphere : this.loc },
      name : { $ne : this.name }
>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
    }).limit(1).exec(cb);
  };

  mongoose.model('Person', PersonSchema);
};
