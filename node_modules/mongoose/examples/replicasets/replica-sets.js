
// import async to make control flow simplier
var async = require('async');

// import the rest of the normal stuff
var mongoose = require('../../lib');

require('./person.js')();

var Person = mongoose.model('Person');

// define some dummy data
var data = [
<<<<<<< HEAD
  {
    name: 'bill',
    age: 25,
    birthday: new Date().setFullYear((new Date().getFullYear() - 25))
  },
  {
    name: 'mary',
    age: 30,
    birthday: new Date().setFullYear((new Date().getFullYear() - 30))
  },
  {
    name: 'bob',
    age: 21,
    birthday: new Date().setFullYear((new Date().getFullYear() - 21))
  },
  {
    name: 'lilly',
    age: 26,
    birthday: new Date().setFullYear((new Date().getFullYear() - 26))
  },
  {
    name: 'alucard',
    age: 1000,
    birthday: new Date().setFullYear((new Date().getFullYear() - 1000))
  }
=======
    {
      name: 'bill',
      age: 25,
      birthday : new Date().setFullYear((new Date().getFullYear() - 25))
    },
    {
      name: 'mary',
      age: 30,
      birthday: new Date().setFullYear((new Date().getFullYear() - 30))
    },
    {
      name: 'bob',
      age: 21,
      birthday : new Date().setFullYear((new Date().getFullYear() - 21))
    },
    {
      name: 'lilly',
      age: 26,
      birthday: new Date().setFullYear((new Date().getFullYear() - 26))
    },
    {
      name: 'alucard',
      age: 1000,
      birthday: new Date().setFullYear((new Date().getFullYear() - 1000))
    }
>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
];


// to connect to a replica set, pass in the comma delimited uri and optionally
// any connection options such as the rs_name.
var opts = {
<<<<<<< HEAD
  replSet: {rs_name: 'rs0'}
=======
  replSet : { rs_name : "rs0" }
>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
};
mongoose.connect('mongodb://localhost:27018/persons,localhost:27019,localhost:27020', opts, function(err) {
  if (err) throw err;

  // create all of the dummy people
  async.each(data, function(item, cb) {
    Person.create(item, cb);
  }, function(err) {
    if (err) {
        // handle error
    }

      // create and delete some data
<<<<<<< HEAD
    var prom = Person.find({age: {$lt: 1000}}).exec();

    prom.then(function(people) {
      console.log('young people: %s', people);
=======
    var prom = Person.find({age : { $lt : 1000 }}).exec();

    prom.then(function(people) {
      console.log("young people: %s", people);
>>>>>>> 28c6f978a4ba08bdae3bd531dac6bebf07cd4f5d
    }).then(cleanup);
  });
});

function cleanup() {
  Person.remove(function() {
    mongoose.disconnect();
  });
}
